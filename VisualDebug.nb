(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     53241,       1405]
NotebookOptionsPosition[     49896,       1292]
NotebookOutlinePosition[     50467,       1311]
CellTagsIndexPosition[     50424,       1308]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "VisualDebug`"}]], "Input",
 CellChangeTimes->{{3.6382878144027433`*^9, 3.638287818342783*^9}, {
  3.638287860417715*^9, 3.6382879281065493`*^9}, {3.639486199714538*^9, 
  3.6394862017113*^9}}],

Cell[CellGroupData[{

Cell["first attempt", "Section",
 CellChangeTimes->{{3.639486178405348*^9, 3.639486190214321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr", "=", 
   RowBox[{"Hold", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "+", "3"}], ",", 
      RowBox[{"5", "^", "2"}], ",", 
      RowBox[{"9", "+", "0"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stringExpr", "=", 
   RowBox[{
    RowBox[{"FullForm", "[", "expr", "]"}], "//", "ToString"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"length", "=", 
   RowBox[{"StringLength", "[", "stringExpr", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"startString", "=", 
     RowBox[{"StringTake", "[", 
      RowBox[{"stringExpr", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"startPos", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"midString", "=", 
     RowBox[{"StringTake", "[", 
      RowBox[{"stringExpr", ",", 
       RowBox[{"{", 
        RowBox[{"startPos", ",", " ", "endPos"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"endString", "=", 
     RowBox[{"StringTake", "[", 
      RowBox[{"stringExpr", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"endPos", "+", "1"}], ",", "length"}], "}"}]}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"startString", ",", 
       RowBox[{"Style", "[", 
        RowBox[{"midString", ",", 
         RowBox[{"FontColor", "\[Rule]", 
          RowBox[{
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "0.5", 
           "]"}]}]}], "]"}], ",", "endString"}], "}"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"expr", ",", "mainPart", ",", "HoldForm"}], "]"}], ",", 
        RowBox[{"FontColor", "\[Rule]", 
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "0.5", 
          "]"}]}]}], "]"}], "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"startPos", ",", "1", ",", "endPos", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"endPos", ",", "length"}], "}"}], ",", "startPos", ",", " ", 
     "length", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"mainPart", ",", "0", ",", " ", 
     RowBox[{"Length", "[", "expr", "]"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.6382922212015743`*^9, 3.638292456563795*^9}, {
   3.638292531711404*^9, 3.6382925846439*^9}, {3.638292616780715*^9, 
   3.6382926400251617`*^9}, {3.6382926730353966`*^9, 
   3.6382927934965563`*^9}, {3.6382928280173645`*^9, 3.638292830341631*^9}, {
   3.6382928722564125`*^9, 3.638292893128008*^9}, {3.6382929331085014`*^9, 
   3.6382929395041323`*^9}, {3.638293082893709*^9, 3.638293093579572*^9}, {
   3.638293376586271*^9, 3.6382933801742706`*^9}, {3.6382934458502707`*^9, 
   3.6382934831966705`*^9}, {3.638293529591071*^9, 3.638293694389923*^9}, {
   3.6382937314713607`*^9, 3.6382937936175966`*^9}, {3.6382938259073195`*^9, 
   3.6382938633290806`*^9}, {3.6382939211542034`*^9, 3.6382939413235807`*^9}, 
   3.638294275932378*^9, {3.6382948104907694`*^9, 3.6382948136110096`*^9}, {
   3.6382948551570053`*^9, 3.6382948689172635`*^9}, {3.638294918342865*^9, 
   3.638294980966082*^9}, {3.638295023385745*^9, 3.63829510004978*^9}, {
   3.6382951393630395`*^9, 3.6382952323732204`*^9}, {3.6382956055160327`*^9, 
   3.6382956267694902`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`endPos$$ = 47, $CellContext`mainPart$$ = 
    1, $CellContext`startPos$$ = 1, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`startPos$$], 1, 
      Dynamic[$CellContext`endPos$$], 1}, {{
       Hold[$CellContext`endPos$$], 47}, 
      Dynamic[$CellContext`startPos$$], 47, 1}, {
      Hold[$CellContext`mainPart$$], 0, 1, 1}}, Typeset`size$$ = {
    187., {3., 9.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`startPos$421873$$ = 
    0, $CellContext`endPos$421874$$ = 0, $CellContext`mainPart$421875$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`endPos$$ = 47, $CellContext`mainPart$$ = 
        0, $CellContext`startPos$$ = 1}, "ControllerVariables" :> {
        Hold[$CellContext`startPos$$, $CellContext`startPos$421873$$, 0], 
        Hold[$CellContext`endPos$$, $CellContext`endPos$421874$$, 0], 
        Hold[$CellContext`mainPart$$, $CellContext`mainPart$421875$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`startString = 
        StringTake[$CellContext`stringExpr, {
          1, $CellContext`startPos$$ - 1}]; $CellContext`midString = 
        StringTake[$CellContext`stringExpr, {$CellContext`startPos$$, \
$CellContext`endPos$$}]; $CellContext`endString = 
        StringTake[$CellContext`stringExpr, {$CellContext`endPos$$ + 
           1, $CellContext`length}]; Row[{$CellContext`startString, 
          
          Style[$CellContext`midString, FontColor -> 
           ColorData["Rainbow"][0.5]], $CellContext`endString}]; Row[{
          Style[
           Extract[$CellContext`expr, $CellContext`mainPart$$, HoldForm], 
           FontColor -> ColorData["Rainbow"][0.5]]}]), 
      "Specifications" :> {{$CellContext`startPos$$, 1, 
         Dynamic[$CellContext`endPos$$], 1, Appearance -> 
         "Labeled"}, {{$CellContext`endPos$$, 47}, 
         Dynamic[$CellContext`startPos$$], 47, 1, Appearance -> 
         "Labeled"}, {$CellContext`mainPart$$, 0, 1, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{381., {92., 97.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6382951569760036`*^9, 3.6382951770850487`*^9}, {
   3.6382952185511775`*^9, 3.6382952332156477`*^9}, 3.638295627206299*^9, 
   3.6386383120370874`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["shape function (depricated)", "Section",
 CellChangeTimes->{{3.639485995908901*^9, 3.6394860052372828`*^9}, 
   3.639486074747763*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringLength", "[", "\"\<Abc\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.638292641148383*^9, 3.6382926595567374`*^9}, {
   3.6382928605882854`*^9, 3.638292864971633*^9}, {3.6382931144677043`*^9, 
   3.6382931193192425`*^9}, {3.638293583598271*^9, 3.638293585626271*^9}, 
   3.639486074716565*^9}],

Cell[BoxData["3"], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.6382926599311447`*^9, {3.638292861461835*^9, 3.638292865455205*^9}, 
   3.6382931200836325`*^9, 3.6382935862034707`*^9, 3.639486074716565*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", 
      RowBox[{"{", 
       RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], "//", 
  "TreeForm"}]], "Input",
 CellChangeTimes->{{3.638295834007964*^9, 3.6382958794651985`*^9}, 
   3.639486074732164*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{1.7356257356397076`, 2.3141676475196102`}, {
    0.7713892158398701, 1.5427784316797402`}, {0., 0.7713892158398701}, {
    0.7713892158398701, 0.7713892158398701}, {1.5427784316797402`, 
    0.7713892158398701}, {2.699862255439545, 1.5427784316797402`}, {
    2.3141676475196102`, 0.7713892158398701}, {3.0855568633594803`, 
    0.7713892158398701}, {2.699862255439545, 0.}, {3.471251471279415, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 6}, {2, 3}, {2, 4}, {2, 5}, {6, 7}, {6, 8}, {8, 
       9}, {8, 10}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"a", ",", 
                 RowBox[{"{", 
                   RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{$CellContext`a, $CellContext`b, $CellContext`c}, \
{$CellContext`a, {$CellContext`b, $CellContext`c}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{$CellContext`a, $CellContext`b, $CellContext`c}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["a",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["a", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`a], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["b",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["b", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`b], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["c",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["c", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`c], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"{", 
           RowBox[{"a", ",", 
             RowBox[{"{", 
               RowBox[{"b", ",", "c"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{$CellContext`a, {$CellContext`b, $CellContext`c}}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["a",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["a", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`a], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox[
         RowBox[{"{", 
           RowBox[{"b", ",", "c"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{$CellContext`b, $CellContext`c}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["b",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["b", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`b], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["c",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0],
           $CellContext`BackFaceColor -> GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox["c", HoldForm]],
       Annotation[#, 
        HoldForm[$CellContext`c], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{1.7356257356397076`, 2.3141676475196102`}, {
     0.7713892158398701, 1.5427784316797402`}, {0., 0.7713892158398701}, {
     0.7713892158398701, 0.7713892158398701}, {1.5427784316797402`, 
     0.7713892158398701}, {2.699862255439545, 1.5427784316797402`}, {
     2.3141676475196102`, 0.7713892158398701}, {3.0855568633594803`, 
     0.7713892158398701}, {2.699862255439545, 0.}, {3.471251471279415, 
     0.}}]& ],
  AspectRatio->1,
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.638295880151581*^9, 3.639486074732164*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"a", "\[Rule]", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", "a", "}"}], "\[Rule]", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"shape", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "d"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "c"}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6382959710353804`*^9, 3.6382960255715823`*^9}, {
   3.638296161742525*^9, 3.6382961670933256`*^9}, {3.6382963590211253`*^9, 
   3.6382963666651254`*^9}, {3.6382966691647253`*^9, 3.6382966815667257`*^9}, 
   3.639486074747763*^9}],

Cell[BoxData[
 RowBox[{"a", "\[Rule]", "0"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6382966721911254`*^9, 3.6382966818007255`*^9}, 
   3.638638371241007*^9, 3.639486074747763*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "a", "}"}], "\[Rule]", "1"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6382966721911254`*^9, 3.6382966818007255`*^9}, 
   3.638638371243007*^9, 3.639486074747763*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6382966721911254`*^9, 3.6382966818007255`*^9}, 
   3.638638371244007*^9, 3.639486074747763*^9}],

Cell[BoxData[
 RowBox[{"shape", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "d"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "c"}], "}"}]}], "}"}], "]"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6382966721911254`*^9, 3.6382966818007255`*^9}, 
   3.6386383712450075`*^9, 3.639486074747763*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Depth", "[", 
  RowBox[{"HoldForm", "[", "a", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6382964000335255`*^9, 3.6382964600155253`*^9}, 
   3.639486074747763*^9}],

Cell[BoxData["2"], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.6382964194867253`*^9, {3.638296453198325*^9, 3.638296460467925*^9}, 
   3.639486074747763*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Remove", "[", "shape", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"shape", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shape", "[", "expr_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Depth", "[", 
        RowBox[{"Unevaluated", "[", "expr", "]"}], "]"}], "\[Equal]", "1"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "0", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Unevaluated", "[", "expr", "]"}], "]"}], ",", 
         RowBox[{"shape", "@@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Unevaluated", ",", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{
                RowBox[{"Hold", "[", "expr", "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}], "\[Rule]", "List"}]}], 
               "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "//", "ReleaseHold"}], 
           ")"}]}]}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6382962586497254`*^9, 3.6382963412683253`*^9}, {
   3.6382964309683256`*^9, 3.6382965050215254`*^9}, {3.6382965394663253`*^9, 
   3.6382965732715254`*^9}, {3.6382966095415254`*^9, 
   3.6382966301647253`*^9}, {3.6382967889734087`*^9, 
   3.6382969418561287`*^9}, {3.6382969968865786`*^9, 
   3.6382970057151594`*^9}, {3.638297066938095*^9, 3.6382970850320067`*^9}, {
   3.638297522713169*^9, 3.6382977029542646`*^9}, {3.638298161695119*^9, 
   3.6382982251091185`*^9}, {3.638298264717519*^9, 3.638298322359519*^9}, {
   3.638298386194719*^9, 3.6382983908435187`*^9}, {3.638300735628786*^9, 
   3.638300736439988*^9}, {3.638301121043063*^9, 3.6383011212146635`*^9}, {
   3.6383016420018167`*^9, 3.6383017157743464`*^9}, {3.6383017665836353`*^9, 
   3.638301855347791*^9}, {3.6383019207275057`*^9, 3.638302049162532*^9}, {
   3.638302249638484*^9, 3.6383022517444873`*^9}, {3.6383022974837675`*^9, 
   3.638302329885025*^9}, {3.6383024204119835`*^9, 3.638302490877308*^9}, 
   3.639486074747763*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr1", "=", 
  RowBox[{"Hold", "[", 
   RowBox[{"2", "+", "2", "+", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "6"}], "+", "3"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sh", "=", 
  RowBox[{"shape", "[", 
   RowBox[{"2", "+", "2", "+", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "^", "6"}], "+", "3"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Position", "[", 
  RowBox[{"%", ",", "_List"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Extract", "[", 
  RowBox[{"expr1", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "1", ",", "1", ",", "2"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.638296969542934*^9, 3.638296973551671*^9}, {
   3.6382970248541512`*^9, 3.6382970250881243`*^9}, {3.638297102735964*^9, 
   3.638297172822413*^9}, {3.638300746782806*^9, 3.638300753412818*^9}, {
   3.6383021804835625`*^9, 3.6383022436168733`*^9}, {3.6383025007833247`*^9, 
   3.638302580406865*^9}, {3.6383031011406674`*^9, 3.6383031077250443`*^9}, {
   3.6383032803927073`*^9, 3.6383032882601576`*^9}, {3.6383033465339217`*^9, 
   3.6383033484527254`*^9}, {3.6383035450920706`*^9, 
   3.6383035576812925`*^9}, {3.638312775906294*^9, 3.638312864946103*^9}, {
   3.638312968639485*^9, 3.638313072551267*^9}, {3.6383131292729673`*^9, 
   3.638313170098239*^9}, 3.639486074747763*^9}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"2", "+", "2", "+", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "0", "2"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "6"], "+", "3"}], ")"}], 
     RowBox[{"\[DifferentialD]", "x"}]}]}]}], "]"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6382971416082134`*^9, 3.6382971740703573`*^9}, 
   3.638297528551169*^9, 3.6382975627521687`*^9, 3.638297675561016*^9, {
   3.638300749684411*^9, 3.638300753990019*^9}, {3.6383016874758964`*^9, 
   3.6383017186447515`*^9}, {3.638301773510048*^9, 3.6383018390925627`*^9}, {
   3.638301949228756*^9, 3.6383020717825713`*^9}, {3.638302178767559*^9, 
   3.638302254677293*^9}, {3.638302301399375*^9, 3.638302331710228*^9}, {
   3.6383024239063897`*^9, 3.6383024464172297`*^9}, {3.6383024947929144`*^9, 
   3.638302537288389*^9}, 3.6383025817328672`*^9, 3.6383031083170776`*^9, 
   3.63830328882119*^9, 3.638303348998726*^9, {3.638303546324473*^9, 
   3.638303557946493*^9}, {3.638312777013357*^9, 3.6383128242612314`*^9}, 
   3.6383128662253046`*^9, {3.6383129694506865`*^9, 3.6383130334419985`*^9}, 
   3.638313073019268*^9, {3.638313142798191*^9, 3.63831317097184*^9}, 
   3.6386383784557285`*^9, 3.639486074747763*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "0"}], "}"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6382971416082134`*^9, 3.6382971740703573`*^9}, 
   3.638297528551169*^9, 3.6382975627521687`*^9, 3.638297675561016*^9, {
   3.638300749684411*^9, 3.638300753990019*^9}, {3.6383016874758964`*^9, 
   3.6383017186447515`*^9}, {3.638301773510048*^9, 3.6383018390925627`*^9}, {
   3.638301949228756*^9, 3.6383020717825713`*^9}, {3.638302178767559*^9, 
   3.638302254677293*^9}, {3.638302301399375*^9, 3.638302331710228*^9}, {
   3.6383024239063897`*^9, 3.6383024464172297`*^9}, {3.6383024947929144`*^9, 
   3.638302537288389*^9}, 3.6383025817328672`*^9, 3.6383031083170776`*^9, 
   3.63830328882119*^9, 3.638303348998726*^9, {3.638303546324473*^9, 
   3.638303557946493*^9}, {3.638312777013357*^9, 3.6383128242612314`*^9}, 
   3.6383128662253046`*^9, {3.6383129694506865`*^9, 3.6383130334419985`*^9}, 
   3.638313073019268*^9, {3.638313142798191*^9, 3.63831317097184*^9}, 
   3.638638378457729*^9, 3.639486074747763*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "2", ",", "1", ",", "2", ",", "1", ",", "2"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "2", ",", "1", ",", "2", ",", "1"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6382971416082134`*^9, 3.6382971740703573`*^9}, 
   3.638297528551169*^9, 3.6382975627521687`*^9, 3.638297675561016*^9, {
   3.638300749684411*^9, 3.638300753990019*^9}, {3.6383016874758964`*^9, 
   3.6383017186447515`*^9}, {3.638301773510048*^9, 3.6383018390925627`*^9}, {
   3.638301949228756*^9, 3.6383020717825713`*^9}, {3.638302178767559*^9, 
   3.638302254677293*^9}, {3.638302301399375*^9, 3.638302331710228*^9}, {
   3.6383024239063897`*^9, 3.6383024464172297`*^9}, {3.6383024947929144`*^9, 
   3.638302537288389*^9}, 3.6383025817328672`*^9, 3.6383031083170776`*^9, 
   3.63830328882119*^9, 3.638303348998726*^9, {3.638303546324473*^9, 
   3.638303557946493*^9}, {3.638312777013357*^9, 3.6383128242612314`*^9}, 
   3.6383128662253046`*^9, {3.6383129694506865`*^9, 3.6383130334419985`*^9}, 
   3.638313073019268*^9, {3.638313142798191*^9, 3.63831317097184*^9}, 
   3.638638378458729*^9, 3.639486074747763*^9}],

Cell[BoxData["6"], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6382971416082134`*^9, 3.6382971740703573`*^9}, 
   3.638297528551169*^9, 3.6382975627521687`*^9, 3.638297675561016*^9, {
   3.638300749684411*^9, 3.638300753990019*^9}, {3.6383016874758964`*^9, 
   3.6383017186447515`*^9}, {3.638301773510048*^9, 3.6383018390925627`*^9}, {
   3.638301949228756*^9, 3.6383020717825713`*^9}, {3.638302178767559*^9, 
   3.638302254677293*^9}, {3.638302301399375*^9, 3.638302331710228*^9}, {
   3.6383024239063897`*^9, 3.6383024464172297`*^9}, {3.6383024947929144`*^9, 
   3.638302537288389*^9}, 3.6383025817328672`*^9, 3.6383031083170776`*^9, 
   3.63830328882119*^9, 3.638303348998726*^9, {3.638303546324473*^9, 
   3.638303557946493*^9}, {3.638312777013357*^9, 3.6383128242612314`*^9}, 
   3.6383128662253046`*^9, {3.6383129694506865`*^9, 3.6383130334419985`*^9}, 
   3.638313073019268*^9, {3.638313142798191*^9, 3.63831317097184*^9}, 
   3.6386383784597287`*^9, 3.639486074747763*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["debug function", "Section",
 CellChangeTimes->{{3.639486016187991*^9, 3.6394860213045616`*^9}}],

Cell[CellGroupData[{

Cell["\<\
expr1=Hold[2+2+Integrate[x^6+3,{x,0,2}]];
debug[expr1, Heads -> False]\
\>", "Input",
 CellChangeTimes->{{3.6383194047241073`*^9, 3.6383194703690224`*^9}, {
   3.6383195397901444`*^9, 3.6383196817971935`*^9}, {3.638319798142198*^9, 
   3.63831980506861*^9}, {3.638320096108536*^9, 3.638320101350145*^9}, {
   3.638320168211862*^9, 3.6383202565080175`*^9}, {3.6383202894396753`*^9, 
   3.6383203465825753`*^9}, {3.638320435611932*^9, 3.6383204462823505`*^9}, {
   3.6383205145178704`*^9, 3.6383205334407034`*^9}, {3.638320572066372*^9, 
   3.6383206046860285`*^9}, {3.638320640035691*^9, 3.6383206549181175`*^9}, {
   3.6383206937777853`*^9, 3.638320767675115*^9}, {3.638320829716424*^9, 
   3.6383208835521183`*^9}, {3.6383209278093967`*^9, 3.638320939384617*^9}, {
   3.6383212490763607`*^9, 3.638321258685978*^9}, 3.638321751679044*^9, {
   3.638321841940802*^9, 3.6383220959872484`*^9}, {3.6383221460165358`*^9, 
   3.638322147014938*^9}, {3.6383221818653994`*^9, 3.6383221844862037`*^9}, {
   3.6383225535058517`*^9, 3.6383225657518735`*^9}, {3.638324900540411*^9, 
   3.6383249764657536`*^9}, {3.6383250406804266`*^9, 3.638325046559763*^9}, {
   3.638325114682659*^9, 3.6383251183878713`*^9}, {3.638325174194063*^9, 
   3.638325175694149*^9}, {3.6383252270850887`*^9, 3.638325228074145*^9}, {
   3.638325499543672*^9, 3.6383255032708855`*^9}, {3.6383256415647955`*^9, 
   3.638325656581654*^9}, {3.6383257788126454`*^9, 3.6383258614113693`*^9}, {
   3.63832591491043*^9, 3.6383259892466817`*^9}, {3.6383260619668407`*^9, 
   3.638326123050335*^9}, {3.638326334500429*^9, 3.638326361517974*^9}, {
   3.6383264195972958`*^9, 3.6383264317329903`*^9}, {3.638636811542406*^9, 
   3.638636831462406*^9}, {3.6386368760244064`*^9, 3.6386368958784065`*^9}, {
   3.63863845757364*^9, 3.638638459145797*^9}, {3.6386385215670385`*^9, 
   3.638638523071189*^9}, {3.6386386069525757`*^9, 3.6386386209309735`*^9}, {
   3.638639586545188*^9, 3.6386395906851883`*^9}, {3.6386396353831882`*^9, 
   3.638639726872188*^9}, {3.6386398281331882`*^9, 3.638639834314188*^9}, {
   3.638639945275188*^9, 3.638639950462188*^9}, {3.638639995661485*^9, 
   3.638640029646883*^9}, {3.6386402825921755`*^9, 3.638640358436759*^9}, {
   3.638640388762791*^9, 3.6386404128482*^9}, {3.638640459507865*^9, 
   3.6386404644033546`*^9}, {3.6386406583537474`*^9, 3.6386406630642185`*^9}, 
   3.6386406993348455`*^9, {3.6386407302289343`*^9, 3.6386407690148125`*^9}, {
   3.6386408126261735`*^9, 3.638640845907501*^9}, 3.638640940056183*^9, {
   3.6386409704631824`*^9, 3.638641003783183*^9}, {3.638642545116617*^9, 
   3.6386425472308283`*^9}, {3.6394858940766706`*^9, 3.6394859276619635`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{VisualDebug`Private`partNumber$$ = 6, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[VisualDebug`Private`partNumber$$], 1, 
      Dynamic[
       Length[VisualDebug`Private`allowedParts$309265]], 1}, {
      Hold[
       Row[{
         Button[
         "Evaluate", 
          VisualDebug`Private`currentExpr$309265 = 
           ReplacePart[
            VisualDebug`Private`currentExpr$309265, 
             VisualDebug`Private`part$309265 -> Evaluate[
               Extract[
               VisualDebug`Private`currentExpr$309265, 
                VisualDebug`Private`part$309265]]]; 
          VisualDebug`Private`allowedParts$309265 = Rest[
             Sort[
              Position[VisualDebug`Private`currentExpr$309265, 
               Blank[], Heads -> 
               OptionValue[{"Heads" -> False}, {Heads -> False}, "Heads"]]]]], 
         Button["Reset", VisualDebug`Private`partNumber$$ = If[
             OptionValue[{"Heads" -> False}, {Heads -> False}, "Heads"], 2, 
             1]; VisualDebug`Private`currentExpr$309265 = $CellContext`expr1; 
          VisualDebug`Private`allowedParts$309265 = Rest[
             Sort[
              Position[VisualDebug`Private`currentExpr$309265, 
               Blank[], Heads -> 
               OptionValue[{"Heads" -> False}, {Heads -> False}, 
                 "Heads"]]]]]}]], Manipulate`Dump`ThisIsNotAControl}}, 
    Typeset`size$$ = {296., {5., 13.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = True, 
    VisualDebug`Private`partNumber$309266$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {VisualDebug`Private`partNumber$$ = 1}, 
      "ControllerVariables" :> {
        Hold[
        VisualDebug`Private`partNumber$$, 
         VisualDebug`Private`partNumber$309266$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (
       VisualDebug`Private`part$309265 = 
        Part[VisualDebug`Private`allowedParts$309265, 
          VisualDebug`Private`partNumber$$]; 
       ReplacePart[
        VisualDebug`Private`currentExpr$309265, 
         VisualDebug`Private`part$309265 -> Style[
           Extract[
           VisualDebug`Private`currentExpr$309265, 
            VisualDebug`Private`part$309265, HoldForm], FontColor -> 
           RGBColor[1, 0, 0], Bold]]), 
      "Specifications" :> {{VisualDebug`Private`partNumber$$, 1, 
         Dynamic[
          Length[VisualDebug`Private`allowedParts$309265]], 1}, 
        Row[{
          Button[
          "Evaluate", 
           VisualDebug`Private`currentExpr$309265 = 
            ReplacePart[
             VisualDebug`Private`currentExpr$309265, 
              VisualDebug`Private`part$309265 -> Evaluate[
                Extract[
                VisualDebug`Private`currentExpr$309265, 
                 VisualDebug`Private`part$309265]]]; 
           VisualDebug`Private`allowedParts$309265 = Rest[
              Sort[
               Position[VisualDebug`Private`currentExpr$309265, 
                Blank[], Heads -> 
                OptionValue[{"Heads" -> False}, {Heads -> False}, 
                  "Heads"]]]]], 
          Button["Reset", VisualDebug`Private`partNumber$$ = If[
              OptionValue[{"Heads" -> False}, {Heads -> False}, "Heads"], 2, 
              1]; VisualDebug`Private`currentExpr$309265 = $CellContext`expr1; 
           VisualDebug`Private`allowedParts$309265 = Rest[
              Sort[
               Position[VisualDebug`Private`currentExpr$309265, 
                Blank[], Heads -> 
                OptionValue[{"Heads" -> False}, {Heads -> False}, 
                  "Heads"]]]]]}]}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{484., {77., 82.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.638639727690188*^9, 3.638639846414188*^9, 3.6386399508841877`*^9, {
   3.6386400139963183`*^9, 3.638640034843403*^9}, 3.6386403138092966`*^9, 
   3.6386403595718727`*^9, {3.63864041335425*^9, 3.638640423220237*^9}, 
   3.6386404651454287`*^9, {3.638640723576269*^9, 3.6386407694618573`*^9}, 
   3.6386408466485753`*^9, 3.638640943201183*^9, {3.6386409776781826`*^9, 
   3.638641004445183*^9}, 3.6386425479609013`*^9, 3.639155444250182*^9, 
   3.6391560295591817`*^9, 3.6391561148811817`*^9, 3.63948593064143*^9, 
   3.639486138252514*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["My step function", "Section",
 CellChangeTimes->{{3.638711520032337*^9, 3.6387115255573373`*^9}}],

Cell[BoxData[{
 RowBox[{"Remove", "[", "step", "]"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "VisualDebug`"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.638795180762426*^9, 3.638795187283142*^9}, {
  3.6392326243813915`*^9, 3.6392326556123915`*^9}, {3.639486123823161*^9, 
  3.6394861319035983`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", "[", "x_", "]"}], ":=", 
  RowBox[{"Exp", "[", "x", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{"k", "[", "x", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "-", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", "x_", "]"}], ":=", 
  RowBox[{"Sin", "[", "x", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", "x_", "]"}], ":=", 
  RowBox[{"x", "^", "2"}]}]}], "Input",
 CellChangeTimes->{{3.6387115482613373`*^9, 3.638711549836337*^9}, {
  3.6387116472743373`*^9, 3.6387117041103373`*^9}, {3.6391565311141815`*^9, 
  3.6391565545149817`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"step", "[", 
  RowBox[{"s", "[", 
   RowBox[{"f", "[", 
    RowBox[{"g", "[", 
     RowBox[{"h", "[", "4", "]"}], "]"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"step", "[", 
  RowBox[{"s", "[", 
   RowBox[{"f", "[", 
    RowBox[{"g", "[", "16", "]"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"step", "[", 
  RowBox[{"s", "[", 
   RowBox[{"f", "[", 
    RowBox[{"Sin", "[", "16", "]"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"step", "[", 
  RowBox[{"s", "[", 
   RowBox[{"k", "[", 
    RowBox[{"Sin", "[", "16", "]"}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6393320393768864`*^9, 3.6393320506244864`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"s", "[", 
   RowBox[{"f", "[", 
    RowBox[{"g", "[", "16", "]"}], "]"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.6392325677343917`*^9, 3.639232659469392*^9, {3.6393042378866043`*^9, 
   3.6393042542856045`*^9}, 3.6393049245446024`*^9, 3.6393050164446025`*^9, 
   3.6393050564436026`*^9, {3.6393051276436024`*^9, 3.6393051582316027`*^9}, {
   3.639332025898486*^9, 3.6393320459288864`*^9}, 3.6394838967735777`*^9, 
   3.63948485044838*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"s", "[", 
   RowBox[{"f", "[", 
    RowBox[{"Sin", "[", "16", "]"}], "]"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.6392325677343917`*^9, 3.639232659469392*^9, {3.6393042378866043`*^9, 
   3.6393042542856045`*^9}, 3.6393049245446024`*^9, 3.6393050164446025`*^9, 
   3.6393050564436026`*^9, {3.6393051276436024`*^9, 3.6393051582316027`*^9}, {
   3.639332025898486*^9, 3.6393320459288864`*^9}, 3.6394838967735777`*^9, 
   3.63948485044838*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"s", "[", 
   RowBox[{"k", "[", 
    RowBox[{"Sin", "[", "16", "]"}], "]"}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.6392325677343917`*^9, 3.639232659469392*^9, {3.6393042378866043`*^9, 
   3.6393042542856045`*^9}, 3.6393049245446024`*^9, 3.6393050164446025`*^9, 
   3.6393050564436026`*^9, {3.6393051276436024`*^9, 3.6393051582316027`*^9}, {
   3.639332025898486*^9, 3.6393320459288864`*^9}, 3.6394838967735777`*^9, 
   3.63948485044838*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"s", "[", 
   RowBox[{
    RowBox[{"-", "2"}], "+", 
    RowBox[{"Sin", "[", "16", "]"}]}], "]"}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.6392325677343917`*^9, 3.639232659469392*^9, {3.6393042378866043`*^9, 
   3.6393042542856045`*^9}, 3.6393049245446024`*^9, 3.6393050164446025`*^9, 
   3.6393050564436026`*^9, {3.6393051276436024`*^9, 3.6393051582316027`*^9}, {
   3.639332025898486*^9, 3.6393320459288864`*^9}, 3.6394838967735777`*^9, 
   3.63948485044838*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"expr", "=", 
  RowBox[{"Unevaluated", "[", 
   RowBox[{"2", "+", 
    RowBox[{"3", "^", "4"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"stepTrace", "[", 
  RowBox[{"2", "+", 
   RowBox[{"3", "^", "4"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.639229942840824*^9, 3.6392301600475426`*^9}, {
  3.6392326843263917`*^9, 3.639232697903392*^9}, {3.6394847947095466`*^9, 
  3.6394848345051465`*^9}}],

Cell[BoxData["83"], "Output",
 CellChangeTimes->{
  3.6392299727468147`*^9, 3.639230009224462*^9, {3.6392300475502944`*^9, 
   3.6392301607316113`*^9}, 3.639232698243392*^9, {3.6394847961759467`*^9, 
   3.639484835363147*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"2", "+", 
     SuperscriptBox["3", "4"]}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"2", "+", "81"}],
    HoldForm], ",", 
   TagBox["83",
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6392299727468147`*^9, 3.639230009224462*^9, {3.6392300475502944`*^9, 
   3.6392301607316113`*^9}, 3.639232698243392*^9, {3.6394847961759467`*^9, 
   3.639484835363147*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"k", "=", "2"}], "\[IndentingNewLine]", 
 RowBox[{"Head", "[", 
  RowBox[{"Unevaluated", "[", "k", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.639233573139392*^9, 3.6392335930823917`*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.639233575022392*^9, 3.6392335935233917`*^9}}],

Cell[BoxData["Symbol"], "Output",
 CellChangeTimes->{{3.639233575022392*^9, 3.639233593527392*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stepTrace", "[", 
  RowBox[{"s", "[", 
   RowBox[{"f", "[", 
    RowBox[{"g", "[", 
     RowBox[{"h", "[", "4", "]"}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6392351580155196`*^9, 3.639235163226041*^9}, {
  3.639305103293603*^9, 3.6393051038846025`*^9}, {3.6394839064289875`*^9, 
  3.6394839131830945`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"s", "[", 
     RowBox[{"f", "[", 
      RowBox[{"g", "[", 
       RowBox[{"h", "[", "4", "]"}], "]"}], "]"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"s", "[", 
     RowBox[{"f", "[", 
      RowBox[{"g", "[", "16", "]"}], "]"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"s", "[", 
     RowBox[{"f", "[", 
      RowBox[{"Sin", "[", "16", "]"}], "]"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"s", "[", 
     RowBox[{"k", "[", 
      RowBox[{"Sin", "[", "16", "]"}], "]"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{"Sin", "[", "16", "]"}]}], "]"}],
    HoldForm], ",", 
   TagBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{"Sin", "[", "16", "]"}]}]],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{{3.6392351635680747`*^9, 3.6392351724669647`*^9}, 
   3.6392352216838856`*^9, {3.639235271010818*^9, 3.6392353007847953`*^9}, 
   3.6392353538020964`*^9, {3.6392353956612816`*^9, 3.63923547275099*^9}, 
   3.6392355400847225`*^9, {3.639235574345148*^9, 3.6392355858873024`*^9}, {
   3.6393042439956045`*^9, 3.639304263006604*^9}, {3.6393051045426025`*^9, 
   3.6393051601476026`*^9}, {3.6393321425692863`*^9, 
   3.6393321448792863`*^9}, {3.639483905071926*^9, 3.639483914228187*^9}, 
   3.6394847897955465`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["A step test", "Section",
 CellChangeTimes->{{3.6393065314506025`*^9, 3.6393065341676025`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "VisualDebug`"}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"x", "+", "x"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6392480495258245`*^9, 3.6392481037848244`*^9}, {
  3.6393045674101973`*^9, 3.639304606987155*^9}, {3.6393047234906025`*^9, 
  3.639304736656603*^9}, {3.6393049580366025`*^9, 3.6393049754816027`*^9}, {
  3.6393051742566023`*^9, 3.6393052745476027`*^9}, {3.6393054882116027`*^9, 
  3.6393055319566026`*^9}, {3.639305832241603*^9, 3.6393058363186026`*^9}, {
  3.6393319813476863`*^9, 3.6393319991876864`*^9}, {3.639483917784622*^9, 
  3.639483919406856*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6393319778066864`*^9, 3.6393319946346865`*^9}, 
   3.639483920420752*^9, {3.639484244112219*^9, 3.6394842624572315`*^9}, {
   3.6394845377765465`*^9, 3.639484551847747*^9}, 3.6394847057573466`*^9, 
   3.6394847885943465`*^9, {3.639485144104334*^9, 3.6394851624812517`*^9}, 
   3.6394852977361045`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"step", "[", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"x", "+", "x"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"step", "[", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"2", "x"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6393062197836027`*^9, 3.6393062476456027`*^9}, {
  3.639484225018431*^9, 3.639484239869155*^9}, {3.6394843356344852`*^9, 
  3.639484337709219*^9}, {3.6394845580565467`*^9, 3.6394845713321466`*^9}, {
  3.6394847100941467`*^9, 3.6394847144465466`*^9}, {3.6394848598552403`*^9, 
  3.639484874784536*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "1"], 
   RowBox[{
    RowBox[{"2", " ", "x"}], 
    RowBox[{"\[DifferentialD]", "x"}]}]}],
  HoldForm]], "Output",
 CellChangeTimes->{
  3.6393062481976023`*^9, {3.6394842194026113`*^9, 3.639484264391569*^9}, 
   3.6394843385671916`*^9, {3.639484539991747*^9, 3.6394845718001466`*^9}, {
   3.6394847078009467`*^9, 3.6394847149457464`*^9}, {3.6394848559552155`*^9, 
   3.6394848752369385`*^9}}],

Cell[BoxData[
 TagBox["1",
  HoldForm]], "Output",
 CellChangeTimes->{
  3.6393062481976023`*^9, {3.6394842194026113`*^9, 3.639484264391569*^9}, 
   3.6394843385671916`*^9, {3.639484539991747*^9, 3.6394845718001466`*^9}, {
   3.6394847078009467`*^9, 3.6394847149457464`*^9}, {3.6394848559552155`*^9, 
   3.6394848752525387`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
stepTrace[Integrate[x+x, {x, 0, 1}]]
stepTracePrint[Integrate[x+x, {x, 0, 1}]]\
\>", "Input",
 CellChangeTimes->{{3.6393058553036027`*^9, 3.6393059558966026`*^9}, {
  3.6394839305129166`*^9, 3.639483943241211*^9}, {3.6394847246655464`*^9, 
  3.6394847311239467`*^9}, {3.6394851461791472`*^9, 3.6394851466939507`*^9}, {
  3.6394853005004025`*^9, 3.6394853095016603`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "1"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "+", "x"}], ")"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}],
    HoldForm], ",", 
   TagBox[
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "1"], 
     RowBox[{
      RowBox[{"2", " ", "x"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}],
    HoldForm], ",", 
   TagBox["1",
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{
  3.639331976539686*^9, {3.639483925240658*^9, 3.639483943662368*^9}, 
   3.6394847317791467`*^9, 3.6394848776393547`*^9, {3.6394851472711544`*^9, 
   3.639485164244063*^9}, {3.6394853016080093`*^9, 3.639485309907263*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "1"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", "+", "x"}], ")"}], 
    RowBox[{"\[DifferentialD]", "x"}]}]}],
  HoldForm]], "Print",
 CellChangeTimes->{3.639485309922863*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{
   SubsuperscriptBox["\[Integral]", "0", "1"], 
   RowBox[{
    RowBox[{"2", " ", "x"}], 
    RowBox[{"\[DifferentialD]", "x"}]}]}],
  HoldForm]], "Print",
 CellChangeTimes->{3.639485309922863*^9}],

Cell[BoxData[
 TagBox["1",
  HoldForm]], "Print",
 CellChangeTimes->{3.639485309922863*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stepTracePrint", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6394853448046865`*^9, 3.6394853526359367`*^9}}],

Cell[BoxData[
 RowBox[{"stepTracePrint", "[", "]"}]], "Output",
 CellChangeTimes->{3.639485667808719*^9}]
}, Open  ]]
}, Closed]]
},
WindowSize->{1475, 794},
WindowMargins->{{65, Automatic}, {Automatic, 35}},
ShowSelection->True,
Magnification->1.,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (March 5, 2013)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "C:", "Users", "pacoj", 
   "AppData", "Roaming", "Mathematica", "SystemFiles", "FrontEnd", 
   "StyleSheets"}, "Default_Paco.nb", CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 222, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[804, 28, 98, 1, 82, "Section"],
Cell[CellGroupData[{
Cell[927, 33, 3802, 91, 292, "Input"],
Cell[4732, 126, 3091, 59, 206, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[7872, 191, 140, 2, 52, "Section"],
Cell[CellGroupData[{
Cell[8037, 197, 321, 5, 31, "Input"],
Cell[8361, 204, 245, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8643, 214, 368, 12, 31, "Input"],
Cell[9014, 228, 8430, 227, 375, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17481, 460, 792, 21, 92, "Input"],
Cell[18276, 483, 224, 5, 32, "Output"],
Cell[18503, 490, 247, 6, 32, "Output"],
Cell[18753, 498, 369, 11, 32, "Output"],
Cell[19125, 511, 378, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19540, 527, 189, 4, 31, "Input"],
Cell[19732, 533, 197, 5, 32, "Output"]
}, Open  ]],
Cell[19944, 541, 2478, 51, 232, "Input"],
Cell[CellGroupData[{
Cell[22447, 596, 1576, 37, 92, "Input"],
Cell[24026, 635, 1282, 24, 50, "Output"],
Cell[25311, 661, 1652, 37, 32, "Output"],
Cell[26966, 700, 1785, 37, 32, "Output"],
Cell[28754, 739, 1018, 15, 32, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[29821, 760, 101, 1, 52, "Section"],
Cell[CellGroupData[{
Cell[29947, 765, 2670, 37, 48, "Input"],
Cell[32620, 804, 5046, 106, 176, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37715, 916, 103, 1, 82, "Section"],
Cell[37821, 919, 318, 6, 52, "Input",
 InitializationCell->True],
Cell[38142, 927, 709, 18, 112, "Input"],
Cell[CellGroupData[{
Cell[38876, 949, 695, 20, 92, "Input"],
Cell[39574, 971, 488, 11, 32, "Output"],
Cell[40065, 984, 490, 11, 32, "Output"],
Cell[40558, 997, 490, 11, 32, "Output"],
Cell[41051, 1010, 505, 12, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41593, 1027, 423, 10, 52, "Input"],
Cell[42019, 1039, 226, 4, 32, "Output"],
Cell[42248, 1045, 437, 15, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42722, 1065, 215, 4, 52, "Input"],
Cell[42940, 1071, 96, 1, 32, "Output"],
Cell[43039, 1074, 99, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43175, 1080, 352, 8, 31, "Input"],
Cell[43530, 1090, 1448, 43, 34, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[45027, 1139, 100, 1, 52, "Section"],
Cell[CellGroupData[{
Cell[45152, 1144, 705, 13, 52, "Input"],
Cell[45860, 1159, 352, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46249, 1169, 764, 19, 52, "Input"],
Cell[47016, 1190, 469, 12, 50, "Output"],
Cell[47488, 1204, 329, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47854, 1216, 380, 7, 48, "Input"],
Cell[48237, 1225, 732, 23, 50, "Output"],
Cell[CellGroupData[{
Cell[48994, 1252, 257, 9, 41, "Print"],
Cell[49254, 1263, 231, 8, 41, "Print"],
Cell[49488, 1273, 91, 3, 24, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49628, 1282, 132, 2, 31, "Input"],
Cell[49763, 1286, 105, 2, 32, "Output"]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
